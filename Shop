using System;
using System.Linq;
using System.Collections.Generic;

namespace Shop
{
    class Program
    {
        private static void Main()
        {
            People people = new People();

            people.FillingArrayOfPersons();
            while (true)
            {
                Console.WriteLine("Комманды:" +
                "\n1)Помотреть товары продавца." +
                "\n2)Купить товар." +
                "\n3)Посмотреть свой инвентарь.");
                Console.Write("\nОтвет: ");

                switch (Convert.ToInt32(Console.ReadLine()))
                {
                    case 1:
                        people.Persons[0].ShowInventory(people.Persons[0], "продавца");
                        break;
                    case 2:
                        people.Persons[1] = people.Persons[1].AddingItemToPlayerInventory(ref people.Persons[0], people.Persons[1]);
                        break;
                    case 3:
                        people.Persons[1].ShowInventory(people.Persons[1], "игрока");
                        break;
                }

                Console.ReadKey();
                Console.Clear();
            }
        }
    }

    class People
    {
        public Person[] Persons { get; private set; }

        public void FillingArrayOfPersons()
        {
            Seller seller = new Seller();
            Player player = new Player();
            Person[] persons =
            {
                new Seller(seller.Goods),
                new Player(player.Goods)
            };

            for (int i = 0; i < persons.Length; i++)
            {
                persons[i].FillingInventory();
            }
            Persons = persons;
        }
    }
}

    class Goods
    {
        public string Product { get; private set; }
        public Goods(string product)
        {
            Product = product;
        }
    }

    abstract class Person
    {
        public Goods[] Goods { get; protected set; }
        private Goods[] _Goods;
        public Person(Goods[] Goods)
        {
            _Goods = Goods;
        }

        public void ShowInventory(Person person, string intventoryOwner)
        {
            Console.WriteLine($"\nИнвентарь {intventoryOwner}:");
            for (int i = 0; i < person.Goods.Length; i++)
            {
                Console.WriteLine($"{i + 1}){person.Goods[i].Product}");
            }
        }

        public Person AddingItemToPlayerInventory(ref Person seller, Person player)
        {
            Goods[] tempGoodsOfPlayer = new Goods[player.Goods.Length + 1];

            seller.ShowInventory(seller, "продавца");
            Console.Write("\nВведите товар, который хотите купить: ");
            int productNumber = Convert.ToInt32(Console.ReadLine()) -1;
            for (int i = 0; i < seller.Goods.Length; i++)
            {
                if (seller.Goods[productNumber].Product == seller.Goods[i].Product)
                {
                    tempGoodsOfPlayer[tempGoodsOfPlayer.Length - 1] = new Goods(seller.Goods[i].Product);
                    seller = seller.RemoveItemFromSellerInventory(i, seller);
                }
            }

            for (int i = 0; i < player.Goods.Length; i++)
            {
                tempGoodsOfPlayer[i] = player.Goods[i];
            }
            player.Goods = tempGoodsOfPlayer;
            return player;
        }

        public Person RemoveItemFromSellerInventory(int i, Person seller)
        {
            List<Goods> tempGoodsOfSeller = seller.Goods.ToList();
            tempGoodsOfSeller.RemoveAt(i);
            seller.Goods = tempGoodsOfSeller.ToArray();
            return seller;
        }

        public abstract void FillingInventory();
    }

    class Seller : Person
    {
        public Seller(Goods[] products = null) : base(products) {}

        public override void FillingInventory()
        {
            Goods[] goods =
            {
                new Goods("Алмазный меч"),
                new Goods("Золотой меч"),
                new Goods("Лук"),
                new Goods("Алмазная броня"),
                new Goods("Топор")
            };
            Goods = goods;
        }
    }

    class Player: Person
    {
        public Player(Goods[] products = null) : base(products) { }

        public override void FillingInventory()
        {
            Goods[] goods = new Goods[0];
            Goods = goods;
        }
    }
