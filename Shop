using System;
using System.Linq;
using System.Collections.Generic;

namespace Shop
{
    class Program
    {
        private static void Main()
        {
            People people = new People();

            people.FillingArrayOfPersons();
            while (true)
            {
                Console.WriteLine("Комманды:" +
                "\n1)Помотреть товары продавца." +
                "\n2)Купить товар." +
                "\n3)Посмотреть свой инвентарь.");
                Console.Write("\nОтвет: ");

                switch (Convert.ToInt32(Console.ReadLine()))
                {
                    case 1:
                        people.Persons[0].ShowInventory("продавца");
                        break;
                    case 2:
                        PurchaseOfGoods(people);
                        break;
                    case 3:
                        people.Persons[1].ShowInventory("игрока");
                        break;
                }

                Console.ReadKey();
                Console.Clear();
            }
        }

        private static void PurchaseOfGoods(People people)
        {
            Goods[] tempGoodsOfPlayer = new Goods[people.Persons[1].Goods.Length + 1];

            people.Persons[0].ShowInventory("продавца");
            Console.Write("\nВведите товар, который хотите купить: ");
            int productNumber = Convert.ToInt32(Console.ReadLine()) - 1;

            for (int i = 0; i < people.Persons[0].Goods.Length; i++)
            {
                if (people.Persons[0].Goods[productNumber].Product == people.Persons[0].Goods[i].Product)
                {
                    tempGoodsOfPlayer[tempGoodsOfPlayer.Length - 1] = new Goods(people.Persons[0].Goods[productNumber].Product);
                    people.Persons[1].AddingItemToPlayerInventory(tempGoodsOfPlayer);
                    people.Persons[0].RemoveItemFromSellerInventory(productNumber);
                }
            }
        }
    }

    class People
    {
        public Person[] Persons { get; private set; }

        public void FillingArrayOfPersons()
        {
            Person[] persons =
            {
                new Seller(),
                new Player()
            };

            for (int i = 0; i < persons.Length; i++)
            {
                persons[i].FillingInventory();
            }
            Persons = persons;
        }
    }

    class Goods
    {
        public string Product { get; private set; }
        public Goods(string product)
        {
            Product = product;
        }
    }

    abstract class Person
    {
        public Goods[] Goods { get; protected set; }

        public void ShowInventory(string inventoryOwner)
        {
            Console.WriteLine($"\nИнвентарь {inventoryOwner}:");
            for (int i = 0; i < Goods.Length; i++)
            {
                Console.WriteLine($"{i + 1}){Goods[i].Product}");
            }
        }

        public void AddingItemToPlayerInventory(Goods[] tempGoodsOfPlayer)
        {
            for (int i = 0; i < Goods.Length; i++)
            {
                tempGoodsOfPlayer[i] = Goods[i];
            }
            Goods = tempGoodsOfPlayer;
        }

        public void RemoveItemFromSellerInventory(int productNumber)
        {
            List<Goods> tempGoodsOfSeller = Goods.ToList();
            tempGoodsOfSeller.RemoveAt(productNumber);
            Goods = tempGoodsOfSeller.ToArray();
        }

        public abstract void FillingInventory();
    }

    class Seller : Person
    {
        public override void FillingInventory()
        {
            Goods[] goods =
            {
                new Goods("Алмазный меч"),
                new Goods("Золотой меч"),
                new Goods("Лук"),
                new Goods("Алмазная броня"),
                new Goods("Топор")
            };
            Goods = goods;
        }
    }

    class Player : Person
    {
        public override void FillingInventory()
        {
            Goods[] goods = new Goods[0];
            Goods = goods;
        }
    }
}
