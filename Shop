using System;
using System.Linq;
using System.Collections.Generic;

namespace Shop
{
    class Program
    {
        private static void Main()
        {
            int sellerIndex = 0, playerIndex = 1;
            Person[] persons =
{
                new Seller(),
                new Player()
            };
            for (int i = 0; i < persons.Length; i++)
            {
                persons[i].FillingInventory();
            }

            while (true)
            {
                Console.WriteLine("Комманды:" +
                "\n1)Помотреть товары продавца." +
                "\n2)Купить товар." +
                "\n3)Посмотреть свой инвентарь.");
                Console.Write("\nОтвет: ");

                switch (Convert.ToInt32(Console.ReadLine()))
                {
                    case 1:
                        persons[sellerIndex].ShowInventory("продавца");
                        break;
                    case 2:
                        PurchaseOfGoods(persons, sellerIndex, playerIndex);
                        break;
                    case 3:
                        persons[playerIndex].ShowInventory("игрока");
                        break;
                }

                Console.ReadKey();
                Console.Clear();
            }
        }

        private static void PurchaseOfGoods(Person[] persons, int sellerIndex, int playerIndex)
        {
            Goods[] tempGoodsOfPlayer = new Goods[persons[playerIndex].Goods.Length + 1];

            persons[sellerIndex].ShowInventory("продавца");
            Console.Write("\nВведите товар, который хотите купить: ");
            int productNumber = Convert.ToInt32(Console.ReadLine()) - 1;

            for (int i = 0; i < persons[sellerIndex].Goods.Length; i++)
            {
                if (persons[sellerIndex].Goods[productNumber].Product == persons[sellerIndex].Goods[i].Product)
                {
                    tempGoodsOfPlayer[tempGoodsOfPlayer.Length - 1] = new Goods(persons[sellerIndex].Goods[productNumber].Product);
                    persons[playerIndex].AddingItemToPlayerInventory(tempGoodsOfPlayer);
                    persons[sellerIndex].RemoveItemFromSellerInventory(productNumber);
                }
            }
        }
    }

    class Goods
    {
        public string Product { get; private set; }
        public Goods(string product)
        {
            Product = product;
        }
    }

    abstract class Person
    {
        public Goods[] Goods { get; protected set; }

        public void ShowInventory(string inventoryOwner)
        {
            Console.WriteLine($"\nИнвентарь {inventoryOwner}:");
            for (int i = 0; i < Goods.Length; i++)
            {
                Console.WriteLine($"{i + 1}){Goods[i].Product}");
            }
        }

        public void AddingItemToPlayerInventory(Goods[] tempGoodsOfPlayer)
        {
            for (int i = 0; i < Goods.Length; i++)
            {
                tempGoodsOfPlayer[i] = Goods[i];
            }
            Goods = tempGoodsOfPlayer;
        }

        public void RemoveItemFromSellerInventory(int productNumber)
        {
            List<Goods> tempGoodsOfSeller = Goods.ToList();
            tempGoodsOfSeller.RemoveAt(productNumber);
            Goods = tempGoodsOfSeller.ToArray();
        }

        public abstract void FillingInventory();
    }

    class Seller : Person
    {
        public override void FillingInventory()
        {
            Goods[] goods =
            {
                new Goods("Алмазный меч"),
                new Goods("Золотой меч"),
                new Goods("Лук"),
                new Goods("Алмазная броня"),
                new Goods("Топор")
            };
            Goods = goods;
        }
    }

    class Player : Person
    {
        public override void FillingInventory()
        {
            Goods[] goods = new Goods[0];
            Goods = goods;
        }
    }
}
